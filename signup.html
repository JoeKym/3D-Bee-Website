<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Sign Up - JoeKym Labs <sup>TM</sup></title>
    <meta name="description" content="Create your JoeKym Labs TM account to access 3D animation and web development services.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="module">import * as THREE from "https://cdn.skypack.dev/three@0.129.0/build/three.module.js";
import { GLTFLoader } from "https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js";
import { gsap } from "https://cdn.skypack.dev/gsap";

const camera = new THREE.PerspectiveCamera(
  10,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.z = 13;
camera.position.y = -1;

const scene = new THREE.Scene();
let bee;
let mixer;
const loader = new GLTFLoader();

loader.load(
  "https://raw.githubusercontent.com/DennysDionigi/bee-glb/94253437c023643dd868592e11a0fd2c228cfe07/demon_bee_full_texture.glb",
  function (gltf) {
    bee = gltf.scene;
    scene.add(bee);
    mixer = new THREE.AnimationMixer(bee);
    mixer.clipAction(gltf.animations[0]).play();
    gsap.to(bee.position, { x: 0, y: -1, z: 0, duration: 2 });
    gsap.to(bee.rotation, { y: 1.5, duration: 2 });
  },
  function (xhr) {
    console.log((xhr.loaded / xhr.total) * 100 + "% loaded");
  },
  function (error) {
    console.error("Error loading model:", error);
  }
);

const renderer = new THREE.WebGLRenderer({ alpha: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.getElementById("container3D").appendChild(renderer.domElement);

const ambientLight = new THREE.AmbientLight(0xffffff, 1.3);
scene.add(ambientLight);

const topLight = new THREE.DirectionalLight(0xffffff, 1);
topLight.position.set(500, 500, 500);
scene.add(topLight);

const reRender3D = () => {
  requestAnimationFrame(reRender3D);
  renderer.render(scene, camera);
  if (mixer) mixer.update(0.02);
};
reRender3D();

window.addEventListener("resize", () => {
  renderer.setSize(window.innerWidth, window.innerHeight);
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
});
</script>
    <link rel="stylesheet" href="https://public.codepenassets.com/css/normalize-5.0.0.min.css">
    <link rel="stylesheet" href="./style.css">
    <style>
      .auth-container {
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2em;
        position: relative;
        z-index: 1;
      }
      .auth-box {
        background-color: rgba(27, 27, 27, 0.85);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(238, 248, 206, 0.1);
        border-radius: 20px;
        padding: 2em 2em;
        width: min(420px, 92vw);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
      .auth-header {
        text-align: center;
        margin-bottom: 1.8em;
      }
      .auth-header h1 {
        font-family: "devil breeze", sans-serif;
        font-size: 2em;
        color: #d1ff48;
        margin-bottom: 0.3em;
        font-weight: bold;
      }
      .auth-header p {
        color: #eef8ce;
        font-size: 0.9em;
        opacity: 0.8;
      }
      .auth-form {
        display: flex;
        flex-direction: column;
        gap: 1.2em;
      }
      .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.4em;
      }
      .form-group label {
        color: #eef8ce;
        font-size: 0.85em;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .form-group input {
        background-color: rgba(238, 248, 206, 0.05);
        border: 1px solid rgba(238, 248, 206, 0.2);
        border-radius: 8px;
        padding: 0.8em;
        color: #eef8ce;
        font-size: 0.95em;
        font-family: "Poppins", sans-serif;
        transition: all 0.3s ease;
      }
      .form-group input:focus {
        outline: none;
        border-color: #d1ff48;
        background-color: rgba(238, 248, 206, 0.08);
        box-shadow: 0 0 0 3px rgba(209, 255, 72, 0.1);
      }
      .form-group input::placeholder {
        color: rgba(238, 248, 206, 0.4);
      }
      .primary-button {
        background-color: #d1ff48;
        color: #1b1b1b;
        border: none;
        border-radius: 8px;
        padding: 0.9em 2em;
        font-size: 1em;
        font-weight: 600;
        font-family: "Poppins", sans-serif;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 0.3em;
      }
      .primary-button:hover {
        background-color: #c4f038;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(209, 255, 72, 0.3);
      }
      .primary-button:active {
        transform: translateY(0);
      }
      .auth-footer {
        text-align: center;
        margin-top: 1.5em;
        padding-top: 1.5em;
        border-top: 1px solid rgba(238, 248, 206, 0.1);
      }
      .auth-footer p {
        color: rgba(238, 248, 206, 0.7);
        font-size: 0.85em;
        margin-bottom: 0.8em;
      }
      .auth-footer a {
        color: #d1ff48;
        text-decoration: none;
        transition: color 0.3s ease;
      }
      .auth-footer a:hover {
        color: #c4f038;
        text-decoration: underline;
      }
      .back-link {
        position: absolute;
        top: 1.5em;
        left: 1.5em;
        color: #eef8ce;
        text-decoration: none;
        font-size: 0.95em;
        display: flex;
        align-items: center;
        gap: 0.5em;
        transition: color 0.3s ease;
        z-index: 100;
      }
      .back-link:hover {
        color: #d1ff48;
      }
      .error-message, .success-message {
        padding: 0.8em;
        border-radius: 8px;
        font-size: 0.85em;
        display: none;
        margin-bottom: 1em;
      }
      .error-message {
        background-color: rgba(255, 0, 0, 0.1);
        border: 1px solid rgba(255, 0, 0, 0.3);
        color: #ff6b6b;
      }
      .success-message {
        background-color: rgba(0, 255, 127, 0.08);
        border: 1px solid rgba(0, 255, 127, 0.2);
        color: #8ef3c5;
      }
      .error-message.show, .success-message.show {
        display: block;
      }
      #container3D {
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
      }
      @media screen and (max-width: 767px) {
        .auth-header h1 {
          font-size: 1.6em;
        }
        .auth-box {
          padding: 1.5em 1.5em;
        }
        .back-link {
          top: 1em;
          left: 1em;
        }
      }
    </style>
  </head>
    
  <body>
    <a href="/" class="back-link">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Back to Home
    </a>
    
    <div class="auth-container">
      <div class="auth-box">
        <div class="auth-header">
          <h1>Create Account</h1>
          <p>Sign up to access JoeKym Labs<sup>TM</sup> experiences</p>
        </div>
        
        <div class="error-message" id="errorMessage"></div>
        <div class="success-message" id="successMessage"></div>
        
        <form class="auth-form" id="signupForm" onsubmit="handleSignup(event)">
          <div class="form-group">
            <label for="fullName">Full Name</label>
            <input 
              type="text" 
              id="fullName" 
              name="fullName" 
              placeholder="Enter your full name"
              required
              autocomplete="name"
            >
          </div>
          
          <div class="form-group">
            <label for="signupEmail">Email Address</label>
            <input 
              type="email" 
              id="signupEmail" 
              name="email" 
              placeholder="Enter your email"
              required
              autocomplete="email"
            >
          </div>
          
          <div class="form-group">
            <label for="signupPassword">Password</label>
            <input 
              type="password" 
              id="signupPassword" 
              name="password" 
              placeholder="Create a password"
              required
              minlength="8"
              autocomplete="new-password"
            >
          </div>
          
          <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input 
              type="password" 
              id="confirmPassword" 
              name="confirmPassword" 
              placeholder="Re-enter your password"
              required
              minlength="8"
              autocomplete="new-password"
            >
          </div>
          
          <button type="submit" class="primary-button">Create Account</button>
        </form>
        
        <div class="auth-footer">
          <p>Already have an account? <a href="/login/">Login here</a></p>
          <p style="margin-top: 1em; font-size: 0.75em; opacity: 0.6;">
            &copy; 2024 JoeKym Labs<sup>TM</sup>. All rights reserved.
          </p>
        </div>
      </div>
    </div>
    
    <div id="container3D"></div>
    
    <script>
      const SIGNUP_ENDPOINT = "https://script.google.com/macros/s/AKfycbySuA3AL-oLvvweelRbamR1moPNg8vyQpeYxld2iTdSQcTKM91SV89m1LHRkMF0X-a9/exec";

      function handleSignup(event) {
        event.preventDefault();
        
        const fullName = document.getElementById('fullName').value.trim();
        const email = document.getElementById('signupEmail').value.trim();
        const password = document.getElementById('signupPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (!fullName || !email || !password || !confirmPassword) {
          showError('Please fill in all fields');
          return;
        }
        
        if (!emailRegex.test(email)) {
          showError('Please enter a valid email address');
          return;
        }
        
        if (password.length < 8) {
          showError('Password must be at least 8 characters long');
          return;
        }
        
        if (password !== confirmPassword) {
          showError('Passwords do not match');
          return;
        }
        
        hideMessage(errorMessage);
        hideMessage(successMessage);
        
        const payload = {
          fullname: fullName,
          email,
          password,
          confirmpassword: confirmPassword
        };

        // Submit using form to iframe (most reliable for Google Apps Script)
        const iframe = document.createElement('iframe');
        iframe.name = 'hiddenSignupFrame';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = SIGNUP_ENDPOINT;
        form.target = 'hiddenSignupFrame';
        
        form.appendChild(createHiddenInput('fullname', payload.fullname));
        form.appendChild(createHiddenInput('email', payload.email));
        form.appendChild(createHiddenInput('password', payload.password));
        form.appendChild(createHiddenInput('confirmpassword', payload.confirmpassword));
        
        document.body.appendChild(form);
        
        let submitted = false;
        iframe.onload = function() {
          if (!submitted) {
            submitted = true;
            // Store user data for profile page
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('userName', fullName);
            sessionStorage.setItem('signupDate', new Date().toISOString());
            
            showSuccess('Account created successfully! Redirecting to your profile...');
            setTimeout(() => {
              document.getElementById('signupForm').reset();
              if (document.body.contains(form)) document.body.removeChild(form);
              if (document.body.contains(iframe)) document.body.removeChild(iframe);
              window.location.href = '/profile/';
            }, 1500);
          }
        };
        
        // Fallback timeout to ensure data is saved
        setTimeout(() => {
          if (!submitted) {
            submitted = true;
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('userName', fullName);
            sessionStorage.setItem('signupDate', new Date().toISOString());
            showSuccess('Account created successfully! Redirecting to your profile...');
            setTimeout(() => {
              document.getElementById('signupForm').reset();
              if (document.body.contains(form)) document.body.removeChild(form);
              if (document.body.contains(iframe)) document.body.removeChild(iframe);
              window.location.href = '/profile/';
            }, 1500);
          }
        }, 2000);
        
        form.submit();
      }
      
      function createHiddenInput(name, value) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = name;
        input.value = value;
        return input;
      }
      
      function showError(message) {
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        successMessage.classList.remove('show');
        successMessage.textContent = '';
        errorMessage.textContent = message;
        errorMessage.classList.add('show');
        setTimeout(() => hideMessage(errorMessage), 5000);
      }
      
      function showSuccess(message) {
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        errorMessage.classList.remove('show');
        errorMessage.textContent = '';
        successMessage.textContent = message;
        successMessage.classList.add('show');
        setTimeout(() => hideMessage(successMessage), 6000);
      }
      
      function hideMessage(element) {
        if (!element) return;
        element.classList.remove('show');
      }
    </script>
  </body>
  
</html>

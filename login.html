<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Login - JoeKym Labsâ„¢</title>
    <meta name="description" content="Login to JoeKym Labs TM - Access your account and explore our 3D animation and web development services.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="module">import * as THREE from "https://cdn.skypack.dev/three@0.129.0/build/three.module.js";
import { GLTFLoader } from "https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js";
import { gsap } from "https://cdn.skypack.dev/gsap";

const camera = new THREE.PerspectiveCamera(
  10,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.z = 13;
camera.position.y = -1;

const scene = new THREE.Scene();
let bee;
let mixer;
const loader = new GLTFLoader();

loader.load(
  "https://raw.githubusercontent.com/DennysDionigi/bee-glb/94253437c023643dd868592e11a0fd2c228cfe07/demon_bee_full_texture.glb",
  function (gltf) {
    bee = gltf.scene;
    scene.add(bee);
    mixer = new THREE.AnimationMixer(bee);
    mixer.clipAction(gltf.animations[0]).play();
    gsap.to(bee.position, { x: 0, y: -1, z: 0, duration: 2 });
    gsap.to(bee.rotation, { y: 1.5, duration: 2 });
  },
  function (xhr) {
    console.log((xhr.loaded / xhr.total) * 100 + "% loaded");
  },
  function (error) {
    console.error("Error loading model:", error);
  }
);

const renderer = new THREE.WebGLRenderer({ alpha: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.getElementById("container3D").appendChild(renderer.domElement);

const ambientLight = new THREE.AmbientLight(0xffffff, 1.3);
scene.add(ambientLight);

const topLight = new THREE.DirectionalLight(0xffffff, 1);
topLight.position.set(500, 500, 500);
scene.add(topLight);

const reRender3D = () => {
  requestAnimationFrame(reRender3D);
  renderer.render(scene, camera);
  if (mixer) mixer.update(0.02);
};
reRender3D();

window.addEventListener("resize", () => {
  renderer.setSize(window.innerWidth, window.innerHeight);
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
});
</script>
    <link rel="stylesheet" href="https://public.codepenassets.com/css/normalize-5.0.0.min.css">
    <link rel="stylesheet" href="./style.css">
    <style>
      .login-container {
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 2em;
        position: relative;
        z-index: 1;
      }
      .login-box {
        background-color: rgba(27, 27, 27, 0.85);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(238, 248, 206, 0.1);
        border-radius: 20px;
        padding: 2em 2em;
        width: min(380px, 90vw);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
      .login-header {
        text-align: center;
        margin-bottom: 1.8em;
      }
      .login-header h1 {
        font-family: "devil breeze", sans-serif;
        font-size: 2em;
        color: #d1ff48;
        margin-bottom: 0.3em;
        font-weight: bold;
      }
      .login-header p {
        color: #eef8ce;
        font-size: 0.9em;
        opacity: 0.8;
      }
      .login-form {
        display: flex;
        flex-direction: column;
        gap: 1.2em;
      }
      .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.4em;
      }
      .form-group label {
        color: #eef8ce;
        font-size: 0.85em;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .form-group input {
        background-color: rgba(238, 248, 206, 0.05);
        border: 1px solid rgba(238, 248, 206, 0.2);
        border-radius: 8px;
        padding: 0.8em;
        color: #eef8ce;
        font-size: 0.95em;
        font-family: "Poppins", sans-serif;
        transition: all 0.3s ease;
      }
      .form-group input:focus {
        outline: none;
        border-color: #d1ff48;
        background-color: rgba(238, 248, 206, 0.08);
        box-shadow: 0 0 0 3px rgba(209, 255, 72, 0.1);
      }
      .form-group input::placeholder {
        color: rgba(238, 248, 206, 0.4);
      }
      .login-button {
        background-color: #d1ff48;
        color: #1b1b1b;
        border: none;
        border-radius: 8px;
        padding: 0.9em 2em;
        font-size: 1em;
        font-weight: 600;
        font-family: "Poppins", sans-serif;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 0.3em;
      }
      .login-button:hover {
        background-color: #c4f038;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(209, 255, 72, 0.3);
      }
      .login-button:active {
        transform: translateY(0);
      }
      .login-footer {
        text-align: center;
        margin-top: 1.5em;
        padding-top: 1.5em;
        border-top: 1px solid rgba(238, 248, 206, 0.1);
      }
      .login-footer p {
        color: rgba(238, 248, 206, 0.7);
        font-size: 0.85em;
        margin-bottom: 0.8em;
      }
      .login-footer a {
        color: #d1ff48;
        text-decoration: none;
        transition: color 0.3s ease;
      }
      .login-footer a:hover {
        color: #c4f038;
        text-decoration: underline;
      }
      .back-link {
        position: absolute;
        top: 1.5em;
        left: 1.5em;
        color: #eef8ce;
        text-decoration: none;
        font-size: 0.95em;
        display: flex;
        align-items: center;
        gap: 0.5em;
        transition: color 0.3s ease;
        z-index: 100;
      }
      .back-link:hover {
        color: #d1ff48;
      }
      .error-message {
        background-color: rgba(255, 0, 0, 0.1);
        border: 1px solid rgba(255, 0, 0, 0.3);
        color: #ff6b6b;
        padding: 0.8em;
        border-radius: 8px;
        font-size: 0.85em;
        display: none;
        margin-bottom: 1em;
      }
      .error-message.show {
        display: block;
      }
      .remember-forgot {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.85em;
      }
      .remember-forgot label {
        display: flex;
        align-items: center;
        gap: 0.5em;
        cursor: pointer;
        color: #eef8ce;
        font-weight: normal;
        text-transform: none;
      }
      .remember-forgot input[type="checkbox"] {
        width: auto;
        margin: 0;
        cursor: pointer;
      }
      .remember-forgot a {
        color: #d1ff48;
        text-decoration: none;
        transition: color 0.3s ease;
      }
      .remember-forgot a:hover {
        color: #c4f038;
        text-decoration: underline;
      }
      #container3D {
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
      }
      @media screen and (max-width: 767px) {
        .login-header h1 {
          font-size: 1.6em;
        }
        .login-box {
          padding: 1.5em 1.5em;
        }
        .back-link {
          top: 1em;
          left: 1em;
        }
      }
    </style>
  </head>
    
  <body>
    <a href="/" class="back-link">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Back to Home
    </a>
    
    <div class="login-container">
      <div class="login-box">
        <div class="login-header">
          <h1>JoeKym Labs<sup>TM</sup></h1>
          <p>Welcome back! Please login to your account</p>
        </div>
        
        <div class="error-message" id="errorMessage"></div>
        
        <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
          <div class="form-group">
            <label for="email">Email Address</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              placeholder="Enter your email"
              required
              autocomplete="email"
            >
          </div>
          
          <div class="form-group">
            <label for="password">Password</label>
            <input 
              type="password" 
              id="password" 
              name="password" 
              placeholder="Enter your password"
              required
              autocomplete="current-password"
            >
          </div>
          
          <div class="remember-forgot">
            <label>
              <input type="checkbox" name="remember" id="remember">
              Remember me
            </label>
            <a href="#forgot-password">Forgot password?</a>
          </div>
          
          <button type="submit" class="login-button">Login</button>
        </form>
        
        <div class="login-footer">
          <p>Don't have an account? <a href="/signup/">Sign up here</a></p>
          <p style="margin-top: 1em; font-size: 0.75em; opacity: 0.6;">
            &copy; 2024 JoeKym Labs<sup>TM</sup>. All rights reserved.
          </p>
        </div>
      </div>
    </div>
    
    <div id="container3D"></div>
    
    <script>
      const LOGIN_ENDPOINT = "https://script.google.com/macros/s/AKfycbxhSH7hHN0nZKWB7EyGvrlFbFuuaLFBCvxgtcb8HaZb8qi0KrWJpHNW_tBmvI3YCc7HjA/exec";

      function handleLogin(event) {
        event.preventDefault();
        
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const errorMessage = document.getElementById('errorMessage');
        
        // Basic validation
        if (!email || !password) {
          showError('Please fill in all fields');
          return;
        }
        
        // Email validation
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          showError('Please enter a valid email address');
          return;
        }
        
        hideError();

        // Use Google Apps Script URL with form data
        const formData = new URLSearchParams();
        formData.append('email', email);
        formData.append('password', password);

        // Submit using form to iframe (most reliable for Google Apps Script)
        const iframe = document.createElement('iframe');
        iframe.name = 'hiddenLoginFrame';
        iframe.style.display = 'none';
        document.body.appendChild(iframe);
        
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = LOGIN_ENDPOINT;
        form.target = 'hiddenLoginFrame';
        
        form.appendChild(createHiddenInput('email', email));
        form.appendChild(createHiddenInput('password', password));
        
        document.body.appendChild(form);
        
        let submitted = false;
        iframe.onload = function() {
          if (!submitted) {
            submitted = true;
            // Store user data for profile page
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('loginDate', new Date().toISOString());
            
            // Small delay to ensure data is saved
            setTimeout(() => {
              alert('Login successful! Redirecting to your profile...');
              document.body.removeChild(form);
              document.body.removeChild(iframe);
              window.location.href = '/profile/';
            }, 500);
          }
        };
        
        // Fallback timeout
        setTimeout(() => {
          if (!submitted) {
            submitted = true;
            sessionStorage.setItem('userEmail', email);
            sessionStorage.setItem('loginDate', new Date().toISOString());
            alert('Login successful! Redirecting to your profile...');
            if (document.body.contains(form)) document.body.removeChild(form);
            if (document.body.contains(iframe)) document.body.removeChild(iframe);
            window.location.href = '/profile/';
          }
        }, 2000);
        
        form.submit();
      }
      
      function createHiddenInput(name, value) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = name;
        input.value = value;
        return input;
      }
      
      function showError(message) {
        const errorMessage = document.getElementById('errorMessage');
        errorMessage.textContent = message;
        errorMessage.classList.add('show');
        setTimeout(() => {
          hideError();
        }, 5000);
      }
      
      function hideError() {
        const errorMessage = document.getElementById('errorMessage');
        errorMessage.classList.remove('show');
      }
    </script>
  </body>
  
</html>
